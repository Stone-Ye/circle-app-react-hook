{"ast":null,"code":"import _defineProperty from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useState, useRef, forwardRef, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport Input from '../input';\nimport Button from '../button';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { SearchOutline } from 'antd-mobile-icons';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { useConfig } from '../config-provider';\nvar classPrefix = \"adm-search-bar\";\nvar defaultProps = {\n  clearable: true,\n  onlyShowClearWhenFocus: false,\n  showCancelButton: false,\n  defaultValue: '',\n  clearOnCancel: true,\n  icon: React.createElement(SearchOutline, null)\n};\nexport var SearchBar = forwardRef(function (p, ref) {\n  var _useConfig = useConfig(),\n      locale = _useConfig.locale;\n\n  var props = mergeProps(defaultProps, {\n    cancelText: locale.common.cancel\n  }, p);\n\n  var _usePropsValue = usePropsValue(props),\n      _usePropsValue2 = _slicedToArray(_usePropsValue, 2),\n      value = _usePropsValue2[0],\n      setValue = _usePropsValue2[1];\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      hasFocus = _useState2[0],\n      setHasFocus = _useState2[1];\n\n  var inputRef = useRef(null);\n  var composingRef = useRef(false);\n  useImperativeHandle(ref, function () {\n    return {\n      clear: function clear() {\n        var _a;\n\n        return (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.clear();\n      },\n      focus: function focus() {\n        var _a;\n\n        return (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n      },\n      blur: function blur() {\n        var _a;\n\n        return (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n      },\n\n      get nativeElement() {\n        var _a, _b;\n\n        return (_b = (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.nativeElement) !== null && _b !== void 0 ? _b : null;\n      }\n\n    };\n  });\n\n  var renderCancelButton = function renderCancelButton() {\n    var isShowCancel;\n\n    if (typeof props.showCancelButton === 'function') {\n      isShowCancel = props.showCancelButton(hasFocus, value);\n    } else {\n      isShowCancel = props.showCancelButton && hasFocus;\n    }\n\n    return isShowCancel && React.createElement(\"div\", {\n      className: \"\".concat(classPrefix, \"-suffix\")\n    }, React.createElement(Button, {\n      fill: 'none',\n      className: \"\".concat(classPrefix, \"-cancel-button\"),\n      onClick: function onClick() {\n        var _a, _b, _c;\n\n        if (props.clearOnCancel) {\n          (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.clear();\n        }\n\n        (_b = inputRef.current) === null || _b === void 0 ? void 0 : _b.blur();\n        (_c = props.onCancel) === null || _c === void 0 ? void 0 : _c.call(props);\n      },\n      onMouseDown: function onMouseDown(e) {\n        e.preventDefault();\n      }\n    }, props.cancelText));\n  };\n\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, _defineProperty({}, \"\".concat(classPrefix, \"-active\"), hasFocus))\n  }, React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-input-box\")\n  }, props.icon && React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-input-box-icon\")\n  }, props.icon), React.createElement(Input, {\n    ref: inputRef,\n    className: classNames(\"\".concat(classPrefix, \"-input\"), _defineProperty({}, \"\".concat(classPrefix, \"-input-without-icon\"), !props.icon)),\n    value: value,\n    onChange: setValue,\n    maxLength: props.maxLength,\n    placeholder: props.placeholder,\n    clearable: props.clearable,\n    onlyShowClearWhenFocus: props.onlyShowClearWhenFocus,\n    onFocus: function onFocus(e) {\n      var _a;\n\n      setHasFocus(true);\n      (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    onBlur: function onBlur(e) {\n      var _a;\n\n      setHasFocus(false);\n      (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    onClear: props.onClear,\n    type: 'search',\n    enterKeyHint: 'search',\n    onEnterPress: function onEnterPress() {\n      var _a, _b;\n\n      if (!composingRef.current) {\n        (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n        (_b = props.onSearch) === null || _b === void 0 ? void 0 : _b.call(props, value);\n      }\n    },\n    \"aria-label\": locale.SearchBar.name,\n    onCompositionStart: function onCompositionStart() {\n      composingRef.current = true;\n    },\n    onCompositionEnd: function onCompositionEnd() {\n      composingRef.current = false;\n    }\n  })), renderCancelButton()));\n});","map":{"version":3,"names":["React","useState","useRef","forwardRef","useImperativeHandle","classNames","Input","Button","withNativeProps","mergeProps","SearchOutline","usePropsValue","useConfig","classPrefix","defaultProps","clearable","onlyShowClearWhenFocus","showCancelButton","defaultValue","clearOnCancel","icon","createElement","SearchBar","p","ref","locale","props","cancelText","common","cancel","value","setValue","hasFocus","setHasFocus","inputRef","composingRef","clear","_a","current","focus","blur","nativeElement","_b","renderCancelButton","isShowCancel","className","fill","onClick","_c","onCancel","call","onMouseDown","e","preventDefault","onChange","maxLength","placeholder","onFocus","onBlur","onClear","type","enterKeyHint","onEnterPress","onSearch","name","onCompositionStart","onCompositionEnd"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/node_modules/antd-mobile/es/components/search-bar/search-bar.js"],"sourcesContent":["import React, { useState, useRef, forwardRef, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport Input from '../input';\nimport Button from '../button';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { SearchOutline } from 'antd-mobile-icons';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { useConfig } from '../config-provider';\nconst classPrefix = `adm-search-bar`;\nconst defaultProps = {\n  clearable: true,\n  onlyShowClearWhenFocus: false,\n  showCancelButton: false,\n  defaultValue: '',\n  clearOnCancel: true,\n  icon: React.createElement(SearchOutline, null)\n};\nexport const SearchBar = forwardRef((p, ref) => {\n  const {\n    locale\n  } = useConfig();\n  const props = mergeProps(defaultProps, {\n    cancelText: locale.common.cancel\n  }, p);\n  const [value, setValue] = usePropsValue(props);\n  const [hasFocus, setHasFocus] = useState(false);\n  const inputRef = useRef(null);\n  const composingRef = useRef(false);\n  useImperativeHandle(ref, () => ({\n    clear: () => {\n      var _a;\n\n      return (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.clear();\n    },\n    focus: () => {\n      var _a;\n\n      return (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n    },\n    blur: () => {\n      var _a;\n\n      return (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n    },\n\n    get nativeElement() {\n      var _a, _b;\n\n      return (_b = (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.nativeElement) !== null && _b !== void 0 ? _b : null;\n    }\n\n  }));\n\n  const renderCancelButton = () => {\n    let isShowCancel;\n\n    if (typeof props.showCancelButton === 'function') {\n      isShowCancel = props.showCancelButton(hasFocus, value);\n    } else {\n      isShowCancel = props.showCancelButton && hasFocus;\n    }\n\n    return isShowCancel && React.createElement(\"div\", {\n      className: `${classPrefix}-suffix`\n    }, React.createElement(Button, {\n      fill: 'none',\n      className: `${classPrefix}-cancel-button`,\n      onClick: () => {\n        var _a, _b, _c;\n\n        if (props.clearOnCancel) {\n          (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.clear();\n        }\n\n        (_b = inputRef.current) === null || _b === void 0 ? void 0 : _b.blur();\n        (_c = props.onCancel) === null || _c === void 0 ? void 0 : _c.call(props);\n      },\n      onMouseDown: e => {\n        e.preventDefault();\n      }\n    }, props.cancelText));\n  };\n\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, {\n      [`${classPrefix}-active`]: hasFocus\n    })\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-input-box`\n  }, props.icon && React.createElement(\"div\", {\n    className: `${classPrefix}-input-box-icon`\n  }, props.icon), React.createElement(Input, {\n    ref: inputRef,\n    className: classNames(`${classPrefix}-input`, {\n      [`${classPrefix}-input-without-icon`]: !props.icon\n    }),\n    value: value,\n    onChange: setValue,\n    maxLength: props.maxLength,\n    placeholder: props.placeholder,\n    clearable: props.clearable,\n    onlyShowClearWhenFocus: props.onlyShowClearWhenFocus,\n    onFocus: e => {\n      var _a;\n\n      setHasFocus(true);\n      (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    onBlur: e => {\n      var _a;\n\n      setHasFocus(false);\n      (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    onClear: props.onClear,\n    type: 'search',\n    enterKeyHint: 'search',\n    onEnterPress: () => {\n      var _a, _b;\n\n      if (!composingRef.current) {\n        (_a = inputRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n        (_b = props.onSearch) === null || _b === void 0 ? void 0 : _b.call(props, value);\n      }\n    },\n    \"aria-label\": locale.SearchBar.name,\n    onCompositionStart: () => {\n      composingRef.current = true;\n    },\n    onCompositionEnd: () => {\n      composingRef.current = false;\n    }\n  })), renderCancelButton()));\n});"],"mappings":"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"},"metadata":{},"sourceType":"module"}