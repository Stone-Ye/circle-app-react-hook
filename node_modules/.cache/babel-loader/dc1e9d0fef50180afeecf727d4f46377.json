{"ast":null,"code":"import _slicedToArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useState, useEffect, forwardRef, useImperativeHandle, memo } from 'react';\nimport classNames from 'classnames';\nimport Popup from '../popup';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport PickerView from '../picker-view';\nimport { generateColumnsExtend, useColumnsExtend } from '../picker-view/columns-extend';\nimport { useConfig } from '../config-provider';\nimport { useMemoizedFn } from 'ahooks';\nimport SafeArea from '../safe-area';\nimport { defaultRenderLabel } from './picker-utils';\nvar classPrefix = \"adm-picker\";\nvar defaultProps = {\n  defaultValue: [],\n  closeOnMaskClick: true,\n  renderLabel: defaultRenderLabel,\n  destroyOnClose: false,\n  forceRender: false\n};\nexport var Picker = memo(forwardRef(function (p, ref) {\n  var _a;\n\n  var _useConfig = useConfig(),\n      locale = _useConfig.locale;\n\n  var props = mergeProps(defaultProps, {\n    confirmText: locale.common.confirm,\n    cancelText: locale.common.cancel\n  }, p);\n\n  var _usePropsValue = usePropsValue({\n    value: props.visible,\n    defaultValue: false,\n    onChange: function onChange(v) {\n      var _a;\n\n      if (v === false) {\n        (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n      }\n    }\n  }),\n      _usePropsValue2 = _slicedToArray(_usePropsValue, 2),\n      visible = _usePropsValue2[0],\n      setVisible = _usePropsValue2[1];\n\n  var actions = {\n    toggle: function toggle() {\n      setVisible(function (v) {\n        return !v;\n      });\n    },\n    open: function open() {\n      setVisible(true);\n    },\n    close: function close() {\n      setVisible(false);\n    }\n  };\n  useImperativeHandle(ref, function () {\n    return actions;\n  });\n\n  var _usePropsValue3 = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: function onChange(val) {\n      var _a;\n\n      var extend = generateColumnsExtend(props.columns, val);\n      (_a = props.onConfirm) === null || _a === void 0 ? void 0 : _a.call(props, val, extend);\n    }\n  })),\n      _usePropsValue4 = _slicedToArray(_usePropsValue3, 2),\n      value = _usePropsValue4[0],\n      setValue = _usePropsValue4[1];\n\n  var extend = useColumnsExtend(props.columns, value);\n\n  var _useState = useState(value),\n      _useState2 = _slicedToArray(_useState, 2),\n      innerValue = _useState2[0],\n      setInnerValue = _useState2[1];\n\n  useEffect(function () {\n    if (innerValue !== value) {\n      setInnerValue(value);\n    }\n  }, [visible]);\n  useEffect(function () {\n    if (!visible) {\n      setInnerValue(value);\n    }\n  }, [value]);\n  var onChange = useMemoizedFn(function (val, ext) {\n    var _a;\n\n    setInnerValue(val);\n\n    if (visible) {\n      (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, val, ext);\n    }\n  });\n  var pickerElement = withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-header\")\n  }, React.createElement(\"a\", {\n    role: 'button',\n    className: \"\".concat(classPrefix, \"-header-button\"),\n    onClick: function onClick() {\n      var _a;\n\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    }\n  }, props.cancelText), React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-header-title\")\n  }, props.title), React.createElement(\"a\", {\n    role: 'button',\n    className: classNames(\"\".concat(classPrefix, \"-header-button\"), props.loading && \"\".concat(classPrefix, \"-header-button-disabled\")),\n    onClick: function onClick() {\n      if (props.loading) return;\n      setValue(innerValue, true);\n      setVisible(false);\n    },\n    \"aria-disabled\": props.loading\n  }, props.confirmText)), React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-body\")\n  }, React.createElement(PickerView, {\n    loading: props.loading,\n    loadingContent: props.loadingContent,\n    columns: props.columns,\n    renderLabel: props.renderLabel,\n    value: innerValue,\n    mouseWheel: props.mouseWheel,\n    onChange: onChange\n  }))));\n  var popupElement = React.createElement(Popup, {\n    style: props.popupStyle,\n    className: classNames(\"\".concat(classPrefix, \"-popup\"), props.popupClassName),\n    visible: visible,\n    position: 'bottom',\n    onMaskClick: function onMaskClick() {\n      var _a;\n\n      if (!props.closeOnMaskClick) return;\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    },\n    getContainer: props.getContainer,\n    destroyOnClose: props.destroyOnClose,\n    afterShow: props.afterShow,\n    afterClose: props.afterClose,\n    onClick: props.onClick,\n    forceRender: props.forceRender,\n    stopPropagation: props.stopPropagation\n  }, pickerElement, React.createElement(SafeArea, {\n    position: 'bottom'\n  }));\n  return React.createElement(React.Fragment, null, popupElement, (_a = props.children) === null || _a === void 0 ? void 0 : _a.call(props, extend.items, actions));\n}));\nPicker.displayName = 'Picker';","map":{"version":3,"names":["React","useState","useEffect","forwardRef","useImperativeHandle","memo","classNames","Popup","mergeProps","withNativeProps","usePropsValue","PickerView","generateColumnsExtend","useColumnsExtend","useConfig","useMemoizedFn","SafeArea","defaultRenderLabel","classPrefix","defaultProps","defaultValue","closeOnMaskClick","renderLabel","destroyOnClose","forceRender","Picker","p","ref","_a","locale","props","confirmText","common","confirm","cancelText","cancel","value","visible","onChange","v","onClose","call","setVisible","actions","toggle","open","close","Object","assign","val","extend","columns","onConfirm","setValue","innerValue","setInnerValue","ext","onSelect","pickerElement","createElement","className","role","onClick","onCancel","title","loading","loadingContent","mouseWheel","popupElement","style","popupStyle","popupClassName","position","onMaskClick","getContainer","afterShow","afterClose","stopPropagation","Fragment","children","items","displayName"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/node_modules/antd-mobile/es/components/picker/picker.js"],"sourcesContent":["import React, { useState, useEffect, forwardRef, useImperativeHandle, memo } from 'react';\nimport classNames from 'classnames';\nimport Popup from '../popup';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport PickerView from '../picker-view';\nimport { generateColumnsExtend, useColumnsExtend } from '../picker-view/columns-extend';\nimport { useConfig } from '../config-provider';\nimport { useMemoizedFn } from 'ahooks';\nimport SafeArea from '../safe-area';\nimport { defaultRenderLabel } from './picker-utils';\nconst classPrefix = `adm-picker`;\nconst defaultProps = {\n  defaultValue: [],\n  closeOnMaskClick: true,\n  renderLabel: defaultRenderLabel,\n  destroyOnClose: false,\n  forceRender: false\n};\nexport const Picker = memo(forwardRef((p, ref) => {\n  var _a;\n\n  const {\n    locale\n  } = useConfig();\n  const props = mergeProps(defaultProps, {\n    confirmText: locale.common.confirm,\n    cancelText: locale.common.cancel\n  }, p);\n  const [visible, setVisible] = usePropsValue({\n    value: props.visible,\n    defaultValue: false,\n    onChange: v => {\n      var _a;\n\n      if (v === false) {\n        (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n      }\n    }\n  });\n  const actions = {\n    toggle: () => {\n      setVisible(v => !v);\n    },\n    open: () => {\n      setVisible(true);\n    },\n    close: () => {\n      setVisible(false);\n    }\n  };\n  useImperativeHandle(ref, () => actions);\n  const [value, setValue] = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: val => {\n      var _a;\n\n      const extend = generateColumnsExtend(props.columns, val);\n      (_a = props.onConfirm) === null || _a === void 0 ? void 0 : _a.call(props, val, extend);\n    }\n  }));\n  const extend = useColumnsExtend(props.columns, value);\n  const [innerValue, setInnerValue] = useState(value);\n  useEffect(() => {\n    if (innerValue !== value) {\n      setInnerValue(value);\n    }\n  }, [visible]);\n  useEffect(() => {\n    if (!visible) {\n      setInnerValue(value);\n    }\n  }, [value]);\n  const onChange = useMemoizedFn((val, ext) => {\n    var _a;\n\n    setInnerValue(val);\n\n    if (visible) {\n      (_a = props.onSelect) === null || _a === void 0 ? void 0 : _a.call(props, val, ext);\n    }\n  });\n  const pickerElement = withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-header`\n  }, React.createElement(\"a\", {\n    role: 'button',\n    className: `${classPrefix}-header-button`,\n    onClick: () => {\n      var _a;\n\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    }\n  }, props.cancelText), React.createElement(\"div\", {\n    className: `${classPrefix}-header-title`\n  }, props.title), React.createElement(\"a\", {\n    role: 'button',\n    className: classNames(`${classPrefix}-header-button`, props.loading && `${classPrefix}-header-button-disabled`),\n    onClick: () => {\n      if (props.loading) return;\n      setValue(innerValue, true);\n      setVisible(false);\n    },\n    \"aria-disabled\": props.loading\n  }, props.confirmText)), React.createElement(\"div\", {\n    className: `${classPrefix}-body`\n  }, React.createElement(PickerView, {\n    loading: props.loading,\n    loadingContent: props.loadingContent,\n    columns: props.columns,\n    renderLabel: props.renderLabel,\n    value: innerValue,\n    mouseWheel: props.mouseWheel,\n    onChange: onChange\n  }))));\n  const popupElement = React.createElement(Popup, {\n    style: props.popupStyle,\n    className: classNames(`${classPrefix}-popup`, props.popupClassName),\n    visible: visible,\n    position: 'bottom',\n    onMaskClick: () => {\n      var _a;\n\n      if (!props.closeOnMaskClick) return;\n      (_a = props.onCancel) === null || _a === void 0 ? void 0 : _a.call(props);\n      setVisible(false);\n    },\n    getContainer: props.getContainer,\n    destroyOnClose: props.destroyOnClose,\n    afterShow: props.afterShow,\n    afterClose: props.afterClose,\n    onClick: props.onClick,\n    forceRender: props.forceRender,\n    stopPropagation: props.stopPropagation\n  }, pickerElement, React.createElement(SafeArea, {\n    position: 'bottom'\n  }));\n  return React.createElement(React.Fragment, null, popupElement, (_a = props.children) === null || _a === void 0 ? void 0 : _a.call(props, extend.items, actions));\n}));\nPicker.displayName = 'Picker';"],"mappings":"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"},"metadata":{},"sourceType":"module"}