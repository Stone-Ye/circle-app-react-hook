{"ast":null,"code":"import _defineProperty from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { MinusOutline, AddOutline } from 'antd-mobile-icons';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { bound } from '../../utils/bound';\nimport Input from '../input';\nimport Button from '../button';\nimport Big from 'big.js';\nimport { useConfig } from '../config-provider';\nvar classPrefix = \"adm-stepper\";\nvar defaultProps = {\n  defaultValue: 0,\n  step: 1,\n  disabled: false,\n  allowEmpty: false\n};\nexport var Stepper = function Stepper(p) {\n  var props = mergeProps(defaultProps, p);\n  var disabled = props.disabled,\n      step = props.step,\n      max = props.max,\n      min = props.min,\n      inputReadOnly = props.inputReadOnly;\n\n  var _useConfig = useConfig(),\n      locale = _useConfig.locale;\n\n  var _usePropsValue = usePropsValue(props),\n      _usePropsValue2 = _slicedToArray(_usePropsValue, 2),\n      value = _usePropsValue2[0],\n      setValue = _usePropsValue2[1];\n\n  var _useState = useState(function () {\n    return convertValueToText(value, props.digits);\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      inputValue = _useState2[0],\n      setInputValue = _useState2[1];\n\n  function setValueWithCheck(v) {\n    if (isNaN(v)) return;\n    var target = bound(v, props.min, props.max);\n\n    if (props.digits !== undefined) {\n      target = parseFloat(target.toFixed(props.digits));\n    }\n\n    setValue(target);\n  }\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      hasFocus = _useState4[0],\n      setHasFocus = _useState4[1];\n\n  useEffect(function () {\n    if (!hasFocus) {\n      setInputValue(convertValueToText(value, props.digits));\n    }\n  }, [hasFocus]);\n  useEffect(function () {\n    if (!hasFocus) {\n      setInputValue(convertValueToText(value, props.digits));\n    }\n  }, [value, props.digits]);\n\n  var handleInputChange = function handleInputChange(v) {\n    setInputValue(v);\n    var value = convertTextToValue(v);\n\n    if (value === null) {\n      if (props.allowEmpty) {\n        setValue(null);\n      } else {\n        setValue(props.defaultValue);\n      }\n    } else {\n      setValueWithCheck(value);\n    }\n  };\n\n  var handleMinus = function handleMinus() {\n    setValueWithCheck(Big(value !== null && value !== void 0 ? value : 0).minus(step).toNumber());\n  };\n\n  var handlePlus = function handlePlus() {\n    setValueWithCheck(Big(value !== null && value !== void 0 ? value : 0).add(step).toNumber());\n  };\n\n  var minusDisabled = function minusDisabled() {\n    if (disabled) return true;\n    if (value === null) return false;\n\n    if (min !== undefined) {\n      return value <= min;\n    }\n\n    return false;\n  };\n\n  var plusDisabled = function plusDisabled() {\n    if (disabled) return true;\n    if (value === null) return false;\n\n    if (max !== undefined) {\n      return value >= max;\n    }\n\n    return false;\n  };\n\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, _defineProperty({}, \"\".concat(classPrefix, \"-active\"), hasFocus))\n  }, React.createElement(Button, {\n    className: \"\".concat(classPrefix, \"-minus\"),\n    onClick: handleMinus,\n    disabled: minusDisabled(),\n    fill: 'none',\n    shape: 'rectangular',\n    color: 'primary',\n    \"aria-label\": locale.Stepper.decrease\n  }, React.createElement(MinusOutline, null)), React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-middle\")\n  }, React.createElement(Input, {\n    className: \"\".concat(classPrefix, \"-input\"),\n    onFocus: function onFocus(e) {\n      var _a;\n\n      setHasFocus(true);\n      (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    value: inputValue,\n    onChange: function onChange(val) {\n      disabled || handleInputChange(val);\n    },\n    disabled: disabled,\n    onBlur: function onBlur(e) {\n      var _a;\n\n      setHasFocus(false);\n      (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    readOnly: inputReadOnly,\n    role: 'spinbutton',\n    \"aria-valuenow\": Number(inputValue),\n    \"aria-valuemax\": max,\n    \"aria-valuemin\": min\n  })), React.createElement(Button, {\n    className: \"\".concat(classPrefix, \"-plus\"),\n    onClick: handlePlus,\n    disabled: plusDisabled(),\n    fill: 'none',\n    shape: 'rectangular',\n    color: 'primary',\n    \"aria-label\": locale.Stepper.increase\n  }, React.createElement(AddOutline, null))));\n};\n\nfunction convertValueToText(value, digits) {\n  if (value === null) return '';\n\n  if (digits !== undefined) {\n    return value.toFixed(digits);\n  } else {\n    return value.toString();\n  }\n}\n\nfunction convertTextToValue(text) {\n  if (text === '') return null;\n  return parseFloat(text);\n}","map":{"version":3,"names":["classNames","React","useEffect","useState","MinusOutline","AddOutline","withNativeProps","usePropsValue","mergeProps","bound","Input","Button","Big","useConfig","classPrefix","defaultProps","defaultValue","step","disabled","allowEmpty","Stepper","p","props","max","min","inputReadOnly","locale","value","setValue","convertValueToText","digits","inputValue","setInputValue","setValueWithCheck","v","isNaN","target","undefined","parseFloat","toFixed","hasFocus","setHasFocus","handleInputChange","convertTextToValue","handleMinus","minus","toNumber","handlePlus","add","minusDisabled","plusDisabled","createElement","className","onClick","fill","shape","color","decrease","onFocus","e","_a","call","onChange","val","onBlur","readOnly","role","Number","increase","toString","text"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/node_modules/antd-mobile/es/components/stepper/stepper.js"],"sourcesContent":["import classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { MinusOutline, AddOutline } from 'antd-mobile-icons';\nimport { withNativeProps } from '../../utils/native-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { bound } from '../../utils/bound';\nimport Input from '../input';\nimport Button from '../button';\nimport Big from 'big.js';\nimport { useConfig } from '../config-provider';\nconst classPrefix = `adm-stepper`;\nconst defaultProps = {\n  defaultValue: 0,\n  step: 1,\n  disabled: false,\n  allowEmpty: false\n};\nexport const Stepper = p => {\n  const props = mergeProps(defaultProps, p);\n  const {\n    disabled,\n    step,\n    max,\n    min,\n    inputReadOnly\n  } = props;\n  const {\n    locale\n  } = useConfig();\n  const [value, setValue] = usePropsValue(props);\n  const [inputValue, setInputValue] = useState(() => convertValueToText(value, props.digits));\n\n  function setValueWithCheck(v) {\n    if (isNaN(v)) return;\n    let target = bound(v, props.min, props.max);\n\n    if (props.digits !== undefined) {\n      target = parseFloat(target.toFixed(props.digits));\n    }\n\n    setValue(target);\n  }\n\n  const [hasFocus, setHasFocus] = useState(false);\n  useEffect(() => {\n    if (!hasFocus) {\n      setInputValue(convertValueToText(value, props.digits));\n    }\n  }, [hasFocus]);\n  useEffect(() => {\n    if (!hasFocus) {\n      setInputValue(convertValueToText(value, props.digits));\n    }\n  }, [value, props.digits]);\n\n  const handleInputChange = v => {\n    setInputValue(v);\n    const value = convertTextToValue(v);\n\n    if (value === null) {\n      if (props.allowEmpty) {\n        setValue(null);\n      } else {\n        setValue(props.defaultValue);\n      }\n    } else {\n      setValueWithCheck(value);\n    }\n  };\n\n  const handleMinus = () => {\n    setValueWithCheck(Big(value !== null && value !== void 0 ? value : 0).minus(step).toNumber());\n  };\n\n  const handlePlus = () => {\n    setValueWithCheck(Big(value !== null && value !== void 0 ? value : 0).add(step).toNumber());\n  };\n\n  const minusDisabled = () => {\n    if (disabled) return true;\n    if (value === null) return false;\n\n    if (min !== undefined) {\n      return value <= min;\n    }\n\n    return false;\n  };\n\n  const plusDisabled = () => {\n    if (disabled) return true;\n    if (value === null) return false;\n\n    if (max !== undefined) {\n      return value >= max;\n    }\n\n    return false;\n  };\n\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classNames(classPrefix, {\n      [`${classPrefix}-active`]: hasFocus\n    })\n  }, React.createElement(Button, {\n    className: `${classPrefix}-minus`,\n    onClick: handleMinus,\n    disabled: minusDisabled(),\n    fill: 'none',\n    shape: 'rectangular',\n    color: 'primary',\n    \"aria-label\": locale.Stepper.decrease\n  }, React.createElement(MinusOutline, null)), React.createElement(\"div\", {\n    className: `${classPrefix}-middle`\n  }, React.createElement(Input, {\n    className: `${classPrefix}-input`,\n    onFocus: e => {\n      var _a;\n\n      setHasFocus(true);\n      (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    value: inputValue,\n    onChange: val => {\n      disabled || handleInputChange(val);\n    },\n    disabled: disabled,\n    onBlur: e => {\n      var _a;\n\n      setHasFocus(false);\n      (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props, e);\n    },\n    readOnly: inputReadOnly,\n    role: 'spinbutton',\n    \"aria-valuenow\": Number(inputValue),\n    \"aria-valuemax\": max,\n    \"aria-valuemin\": min\n  })), React.createElement(Button, {\n    className: `${classPrefix}-plus`,\n    onClick: handlePlus,\n    disabled: plusDisabled(),\n    fill: 'none',\n    shape: 'rectangular',\n    color: 'primary',\n    \"aria-label\": locale.Stepper.increase\n  }, React.createElement(AddOutline, null))));\n};\n\nfunction convertValueToText(value, digits) {\n  if (value === null) return '';\n\n  if (digits !== undefined) {\n    return value.toFixed(digits);\n  } else {\n    return value.toString();\n  }\n}\n\nfunction convertTextToValue(text) {\n  if (text === '') return null;\n  return parseFloat(text);\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}