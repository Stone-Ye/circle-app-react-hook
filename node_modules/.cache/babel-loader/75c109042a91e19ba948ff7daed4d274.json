{"ast":null,"code":"import _slicedToArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport classNames from 'classnames';\nimport React, { useState, useRef } from 'react';\nimport { useIsomorphicLayoutEffect, useUnmountedRef } from 'ahooks';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport Mask from '../mask';\nimport { useLockScroll } from '../../utils/use-lock-scroll';\nimport { renderToContainer } from '../../utils/render-to-container';\nimport { useSpring, animated } from '@react-spring/web';\nimport { withStopPropagation } from '../../utils/with-stop-propagation';\nimport { ShouldRender } from '../../utils/should-render';\nimport { CloseOutline } from 'antd-mobile-icons';\nimport { defaultPopupBaseProps } from './popup-base-props';\nimport { useInnerVisible } from '../../utils/use-inner-visible';\nvar classPrefix = \"adm-popup\";\nvar defaultProps = Object.assign(Object.assign({}, defaultPopupBaseProps), {\n  position: 'bottom'\n});\nexport var Popup = function Popup(p) {\n  var props = mergeProps(defaultProps, p);\n  var bodyCls = classNames(\"\".concat(classPrefix, \"-body\"), props.bodyClassName, \"\".concat(classPrefix, \"-body-position-\").concat(props.position));\n\n  var _useState = useState(props.visible),\n      _useState2 = _slicedToArray(_useState, 2),\n      active = _useState2[0],\n      setActive = _useState2[1];\n\n  useIsomorphicLayoutEffect(function () {\n    if (props.visible) {\n      setActive(true);\n    }\n  }, [props.visible]);\n  var ref = useRef(null);\n  useLockScroll(ref, props.disableBodyScroll && active);\n  var unmountedRef = useUnmountedRef();\n\n  var _useSpring = useSpring({\n    percent: props.visible ? 0 : 100,\n    config: {\n      precision: 0.1,\n      mass: 0.4,\n      tension: 300,\n      friction: 30\n    },\n    onRest: function onRest() {\n      var _a, _b;\n\n      if (unmountedRef.current) return;\n      setActive(props.visible);\n\n      if (props.visible) {\n        (_a = props.afterShow) === null || _a === void 0 ? void 0 : _a.call(props);\n      } else {\n        (_b = props.afterClose) === null || _b === void 0 ? void 0 : _b.call(props);\n      }\n    }\n  }),\n      percent = _useSpring.percent;\n\n  var maskVisible = useInnerVisible(active && props.visible);\n  var node = withStopPropagation(props.stopPropagation, withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix,\n    onClick: props.onClick,\n    style: {\n      display: active ? undefined : 'none'\n    }\n  }, props.mask && React.createElement(Mask, {\n    visible: maskVisible,\n    forceRender: props.forceRender,\n    destroyOnClose: props.destroyOnClose,\n    onMaskClick: function onMaskClick(e) {\n      var _a, _b;\n\n      (_a = props.onMaskClick) === null || _a === void 0 ? void 0 : _a.call(props, e);\n\n      if (props.closeOnMaskClick) {\n        (_b = props.onClose) === null || _b === void 0 ? void 0 : _b.call(props);\n      }\n    },\n    className: props.maskClassName,\n    style: props.maskStyle,\n    disableBodyScroll: false,\n    stopPropagation: props.stopPropagation\n  }), React.createElement(animated.div, {\n    className: bodyCls,\n    style: Object.assign(Object.assign({}, props.bodyStyle), {\n      transform: percent.to(function (v) {\n        if (props.position === 'bottom') {\n          return \"translate(0, \".concat(v, \"%)\");\n        }\n\n        if (props.position === 'top') {\n          return \"translate(0, -\".concat(v, \"%)\");\n        }\n\n        if (props.position === 'left') {\n          return \"translate(-\".concat(v, \"%, 0)\");\n        }\n\n        if (props.position === 'right') {\n          return \"translate(\".concat(v, \"%, 0)\");\n        }\n\n        return 'none';\n      })\n    }),\n    ref: ref\n  }, props.showCloseButton && React.createElement(\"a\", {\n    className: classNames(\"\".concat(classPrefix, \"-close-icon\"), 'adm-plain-anchor'),\n    onClick: function onClick() {\n      var _a;\n\n      (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, React.createElement(CloseOutline, null)), props.children))));\n  return React.createElement(ShouldRender, {\n    active: active,\n    forceRender: props.forceRender,\n    destroyOnClose: props.destroyOnClose\n  }, renderToContainer(props.getContainer, node));\n};","map":{"version":3,"names":["classNames","React","useState","useRef","useIsomorphicLayoutEffect","useUnmountedRef","withNativeProps","mergeProps","Mask","useLockScroll","renderToContainer","useSpring","animated","withStopPropagation","ShouldRender","CloseOutline","defaultPopupBaseProps","useInnerVisible","classPrefix","defaultProps","Object","assign","position","Popup","p","props","bodyCls","bodyClassName","visible","active","setActive","ref","disableBodyScroll","unmountedRef","percent","config","precision","mass","tension","friction","onRest","_a","_b","current","afterShow","call","afterClose","maskVisible","node","stopPropagation","createElement","className","onClick","style","display","undefined","mask","forceRender","destroyOnClose","onMaskClick","e","closeOnMaskClick","onClose","maskClassName","maskStyle","div","bodyStyle","transform","to","v","showCloseButton","children","getContainer"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/node_modules/antd-mobile/es/components/popup/popup.js"],"sourcesContent":["import classNames from 'classnames';\nimport React, { useState, useRef } from 'react';\nimport { useIsomorphicLayoutEffect, useUnmountedRef } from 'ahooks';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport Mask from '../mask';\nimport { useLockScroll } from '../../utils/use-lock-scroll';\nimport { renderToContainer } from '../../utils/render-to-container';\nimport { useSpring, animated } from '@react-spring/web';\nimport { withStopPropagation } from '../../utils/with-stop-propagation';\nimport { ShouldRender } from '../../utils/should-render';\nimport { CloseOutline } from 'antd-mobile-icons';\nimport { defaultPopupBaseProps } from './popup-base-props';\nimport { useInnerVisible } from '../../utils/use-inner-visible';\nconst classPrefix = `adm-popup`;\nconst defaultProps = Object.assign(Object.assign({}, defaultPopupBaseProps), {\n  position: 'bottom'\n});\nexport const Popup = p => {\n  const props = mergeProps(defaultProps, p);\n  const bodyCls = classNames(`${classPrefix}-body`, props.bodyClassName, `${classPrefix}-body-position-${props.position}`);\n  const [active, setActive] = useState(props.visible);\n  useIsomorphicLayoutEffect(() => {\n    if (props.visible) {\n      setActive(true);\n    }\n  }, [props.visible]);\n  const ref = useRef(null);\n  useLockScroll(ref, props.disableBodyScroll && active);\n  const unmountedRef = useUnmountedRef();\n  const {\n    percent\n  } = useSpring({\n    percent: props.visible ? 0 : 100,\n    config: {\n      precision: 0.1,\n      mass: 0.4,\n      tension: 300,\n      friction: 30\n    },\n    onRest: () => {\n      var _a, _b;\n\n      if (unmountedRef.current) return;\n      setActive(props.visible);\n\n      if (props.visible) {\n        (_a = props.afterShow) === null || _a === void 0 ? void 0 : _a.call(props);\n      } else {\n        (_b = props.afterClose) === null || _b === void 0 ? void 0 : _b.call(props);\n      }\n    }\n  });\n  const maskVisible = useInnerVisible(active && props.visible);\n  const node = withStopPropagation(props.stopPropagation, withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix,\n    onClick: props.onClick,\n    style: {\n      display: active ? undefined : 'none'\n    }\n  }, props.mask && React.createElement(Mask, {\n    visible: maskVisible,\n    forceRender: props.forceRender,\n    destroyOnClose: props.destroyOnClose,\n    onMaskClick: e => {\n      var _a, _b;\n\n      (_a = props.onMaskClick) === null || _a === void 0 ? void 0 : _a.call(props, e);\n\n      if (props.closeOnMaskClick) {\n        (_b = props.onClose) === null || _b === void 0 ? void 0 : _b.call(props);\n      }\n    },\n    className: props.maskClassName,\n    style: props.maskStyle,\n    disableBodyScroll: false,\n    stopPropagation: props.stopPropagation\n  }), React.createElement(animated.div, {\n    className: bodyCls,\n    style: Object.assign(Object.assign({}, props.bodyStyle), {\n      transform: percent.to(v => {\n        if (props.position === 'bottom') {\n          return `translate(0, ${v}%)`;\n        }\n\n        if (props.position === 'top') {\n          return `translate(0, -${v}%)`;\n        }\n\n        if (props.position === 'left') {\n          return `translate(-${v}%, 0)`;\n        }\n\n        if (props.position === 'right') {\n          return `translate(${v}%, 0)`;\n        }\n\n        return 'none';\n      })\n    }),\n    ref: ref\n  }, props.showCloseButton && React.createElement(\"a\", {\n    className: classNames(`${classPrefix}-close-icon`, 'adm-plain-anchor'),\n    onClick: () => {\n      var _a;\n\n      (_a = props.onClose) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, React.createElement(CloseOutline, null)), props.children))));\n  return React.createElement(ShouldRender, {\n    active: active,\n    forceRender: props.forceRender,\n    destroyOnClose: props.destroyOnClose\n  }, renderToContainer(props.getContainer, node));\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}