{"ast":null,"code":"import _slicedToArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { useSpring } from '@react-spring/web';\nimport { useMutationEffect } from './use-mutation-effect';\nimport { bound } from './bound';\nimport { useIsomorphicLayoutEffect } from 'ahooks';\nimport { useIsomorphicUpdateLayoutEffect } from './use-isomorphic-update-layout-effect';\nexport var useTabListScroll = function useTabListScroll(targetRef, activeIndex) {\n  var _useSpring = useSpring(function () {\n    return {\n      scrollLeft: 0,\n      config: {\n        tension: 300,\n        clamp: true\n      }\n    };\n  }),\n      _useSpring2 = _slicedToArray(_useSpring, 2),\n      scrollLeft = _useSpring2[0].scrollLeft,\n      api = _useSpring2[1];\n\n  function animate() {\n    var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    var container = targetRef.current;\n    if (!container) return;\n    if (activeIndex === undefined) return;\n    var activeTabWrapper = container.children.item(activeIndex);\n    var activeTab = activeTabWrapper.children.item(0);\n    var activeTabLeft = activeTab.offsetLeft;\n    var activeTabWidth = activeTab.offsetWidth;\n    var containerWidth = container.offsetWidth;\n    var containerScrollWidth = container.scrollWidth;\n    var containerScrollLeft = container.scrollLeft;\n    var maxScrollDistance = containerScrollWidth - containerWidth;\n    if (maxScrollDistance <= 0) return;\n    var nextScrollLeft = bound(activeTabLeft - (containerWidth - activeTabWidth) / 2, 0, containerScrollWidth - containerWidth);\n    api.start({\n      scrollLeft: nextScrollLeft,\n      from: {\n        scrollLeft: containerScrollLeft\n      },\n      immediate: immediate && !scrollLeft.isAnimating\n    });\n  }\n\n  useIsomorphicLayoutEffect(function () {\n    animate(true);\n  }, []);\n  useIsomorphicUpdateLayoutEffect(function () {\n    animate();\n  }, [activeIndex]);\n  useMutationEffect(function () {\n    animate(true);\n  }, targetRef, {\n    subtree: true,\n    childList: true,\n    characterData: true\n  });\n  return {\n    scrollLeft: scrollLeft,\n    animate: animate\n  };\n};","map":{"version":3,"names":["useSpring","useMutationEffect","bound","useIsomorphicLayoutEffect","useIsomorphicUpdateLayoutEffect","useTabListScroll","targetRef","activeIndex","scrollLeft","config","tension","clamp","api","animate","immediate","container","current","undefined","activeTabWrapper","children","item","activeTab","activeTabLeft","offsetLeft","activeTabWidth","offsetWidth","containerWidth","containerScrollWidth","scrollWidth","containerScrollLeft","maxScrollDistance","nextScrollLeft","start","from","isAnimating","subtree","childList","characterData"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/node_modules/antd-mobile/es/utils/use-tab-list-scroll.js"],"sourcesContent":["import { useSpring } from '@react-spring/web';\nimport { useMutationEffect } from './use-mutation-effect';\nimport { bound } from './bound';\nimport { useIsomorphicLayoutEffect } from 'ahooks';\nimport { useIsomorphicUpdateLayoutEffect } from './use-isomorphic-update-layout-effect';\nexport const useTabListScroll = (targetRef, activeIndex) => {\n  const [{\n    scrollLeft\n  }, api] = useSpring(() => ({\n    scrollLeft: 0,\n    config: {\n      tension: 300,\n      clamp: true\n    }\n  }));\n\n  function animate(immediate = false) {\n    const container = targetRef.current;\n    if (!container) return;\n    if (activeIndex === undefined) return;\n    const activeTabWrapper = container.children.item(activeIndex);\n    const activeTab = activeTabWrapper.children.item(0);\n    const activeTabLeft = activeTab.offsetLeft;\n    const activeTabWidth = activeTab.offsetWidth;\n    const containerWidth = container.offsetWidth;\n    const containerScrollWidth = container.scrollWidth;\n    const containerScrollLeft = container.scrollLeft;\n    const maxScrollDistance = containerScrollWidth - containerWidth;\n    if (maxScrollDistance <= 0) return;\n    const nextScrollLeft = bound(activeTabLeft - (containerWidth - activeTabWidth) / 2, 0, containerScrollWidth - containerWidth);\n    api.start({\n      scrollLeft: nextScrollLeft,\n      from: {\n        scrollLeft: containerScrollLeft\n      },\n      immediate: immediate && !scrollLeft.isAnimating\n    });\n  }\n\n  useIsomorphicLayoutEffect(() => {\n    animate(true);\n  }, []);\n  useIsomorphicUpdateLayoutEffect(() => {\n    animate();\n  }, [activeIndex]);\n  useMutationEffect(() => {\n    animate(true);\n  }, targetRef, {\n    subtree: true,\n    childList: true,\n    characterData: true\n  });\n  return {\n    scrollLeft,\n    animate\n  };\n};"],"mappings":";AAAA,SAASA,SAAT,QAA0B,mBAA1B;AACA,SAASC,iBAAT,QAAkC,uBAAlC;AACA,SAASC,KAAT,QAAsB,SAAtB;AACA,SAASC,yBAAT,QAA0C,QAA1C;AACA,SAASC,+BAAT,QAAgD,uCAAhD;AACA,OAAO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,SAAD,EAAYC,WAAZ,EAA4B;EAC1D,iBAEUP,SAAS,CAAC;IAAA,OAAO;MACzBQ,UAAU,EAAE,CADa;MAEzBC,MAAM,EAAE;QACNC,OAAO,EAAE,GADH;QAENC,KAAK,EAAE;MAFD;IAFiB,CAAP;EAAA,CAAD,CAFnB;EAAA;EAAA,IACEH,UADF,kBACEA,UADF;EAAA,IAEGI,GAFH;;EAUA,SAASC,OAAT,GAAoC;IAAA,IAAnBC,SAAmB,uEAAP,KAAO;IAClC,IAAMC,SAAS,GAAGT,SAAS,CAACU,OAA5B;IACA,IAAI,CAACD,SAAL,EAAgB;IAChB,IAAIR,WAAW,KAAKU,SAApB,EAA+B;IAC/B,IAAMC,gBAAgB,GAAGH,SAAS,CAACI,QAAV,CAAmBC,IAAnB,CAAwBb,WAAxB,CAAzB;IACA,IAAMc,SAAS,GAAGH,gBAAgB,CAACC,QAAjB,CAA0BC,IAA1B,CAA+B,CAA/B,CAAlB;IACA,IAAME,aAAa,GAAGD,SAAS,CAACE,UAAhC;IACA,IAAMC,cAAc,GAAGH,SAAS,CAACI,WAAjC;IACA,IAAMC,cAAc,GAAGX,SAAS,CAACU,WAAjC;IACA,IAAME,oBAAoB,GAAGZ,SAAS,CAACa,WAAvC;IACA,IAAMC,mBAAmB,GAAGd,SAAS,CAACP,UAAtC;IACA,IAAMsB,iBAAiB,GAAGH,oBAAoB,GAAGD,cAAjD;IACA,IAAII,iBAAiB,IAAI,CAAzB,EAA4B;IAC5B,IAAMC,cAAc,GAAG7B,KAAK,CAACoB,aAAa,GAAG,CAACI,cAAc,GAAGF,cAAlB,IAAoC,CAArD,EAAwD,CAAxD,EAA2DG,oBAAoB,GAAGD,cAAlF,CAA5B;IACAd,GAAG,CAACoB,KAAJ,CAAU;MACRxB,UAAU,EAAEuB,cADJ;MAERE,IAAI,EAAE;QACJzB,UAAU,EAAEqB;MADR,CAFE;MAKRf,SAAS,EAAEA,SAAS,IAAI,CAACN,UAAU,CAAC0B;IAL5B,CAAV;EAOD;;EAED/B,yBAAyB,CAAC,YAAM;IAC9BU,OAAO,CAAC,IAAD,CAAP;EACD,CAFwB,EAEtB,EAFsB,CAAzB;EAGAT,+BAA+B,CAAC,YAAM;IACpCS,OAAO;EACR,CAF8B,EAE5B,CAACN,WAAD,CAF4B,CAA/B;EAGAN,iBAAiB,CAAC,YAAM;IACtBY,OAAO,CAAC,IAAD,CAAP;EACD,CAFgB,EAEdP,SAFc,EAEH;IACZ6B,OAAO,EAAE,IADG;IAEZC,SAAS,EAAE,IAFC;IAGZC,aAAa,EAAE;EAHH,CAFG,CAAjB;EAOA,OAAO;IACL7B,UAAU,EAAVA,UADK;IAELK,OAAO,EAAPA;EAFK,CAAP;AAID,CAnDM"},"metadata":{},"sourceType":"module"}