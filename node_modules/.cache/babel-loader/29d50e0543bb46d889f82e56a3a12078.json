{"ast":null,"code":"import _defineProperty from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _slicedToArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { forwardRef, useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport classNames from 'classnames';\nimport { CloseCircleFill } from 'antd-mobile-icons';\nimport { useIsomorphicLayoutEffect } from 'ahooks';\nvar classPrefix = 'adm-virtual-input';\nvar defaultProps = {\n  defaultValue: ''\n};\nexport var VirtualInput = forwardRef(function (p, ref) {\n  var props = mergeProps(defaultProps, p);\n\n  var _usePropsValue = usePropsValue(props),\n      _usePropsValue2 = _slicedToArray(_usePropsValue, 2),\n      value = _usePropsValue2[0],\n      setValue = _usePropsValue2[1];\n\n  var rootRef = useRef(null);\n  var contentRef = useRef(null);\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      hasFocus = _useState2[0],\n      setHasFocus = _useState2[1];\n\n  function scrollToEnd() {\n    var root = rootRef.current;\n    if (!root) return;\n\n    if (document.activeElement !== root) {\n      return;\n    }\n\n    var content = contentRef.current;\n    if (!content) return;\n    content.scrollLeft = content.clientWidth;\n  }\n\n  useIsomorphicLayoutEffect(function () {\n    scrollToEnd();\n  }, [value]);\n  useEffect(function () {\n    if (hasFocus) {\n      scrollToEnd();\n    }\n  }, [hasFocus]);\n  useImperativeHandle(ref, function () {\n    return {\n      focus: function focus() {\n        var _a;\n\n        (_a = rootRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n      },\n      blur: function blur() {\n        var _a;\n\n        (_a = rootRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n      }\n    };\n  });\n\n  function onFocus() {\n    var _a;\n\n    setHasFocus(true);\n    (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props);\n  }\n\n  function onBlur() {\n    var _a;\n\n    setHasFocus(false);\n    (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props);\n  }\n\n  var keyboard = props.keyboard;\n  var keyboardElement = keyboard && React.cloneElement(keyboard, {\n    onInput: function onInput(v) {\n      var _a, _b;\n\n      setValue(value + v);\n      (_b = (_a = keyboard.props).onInput) === null || _b === void 0 ? void 0 : _b.call(_a, v);\n    },\n    onDelete: function onDelete() {\n      var _a, _b;\n\n      setValue(value.slice(0, -1));\n      (_b = (_a = keyboard.props).onDelete) === null || _b === void 0 ? void 0 : _b.call(_a);\n    },\n    visible: hasFocus,\n    onClose: function onClose() {\n      var _a, _b, _c;\n\n      (_a = rootRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n      (_c = (_b = keyboard.props).onClose) === null || _c === void 0 ? void 0 : _c.call(_b);\n    },\n    getContainer: null\n  });\n  return withNativeProps(props, React.createElement(\"div\", {\n    ref: rootRef,\n    className: classNames(classPrefix, _defineProperty({}, \"\".concat(classPrefix, \"-disabled\"), props.disabled)),\n    tabIndex: props.disabled ? undefined : 0,\n    onFocus: onFocus,\n    onBlur: onBlur,\n    onClick: props.onClick\n  }, React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-content\"),\n    ref: contentRef\n  }, value, React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-caret-container\")\n  }, hasFocus && React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-caret\")\n  }))), props.clearable && !!value && hasFocus && React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-clear\"),\n    onClick: function onClick(e) {\n      var _a;\n\n      e.stopPropagation();\n      setValue('');\n      (_a = props.onClear) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, React.createElement(CloseCircleFill, null)), !value && React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-placeholder\")\n  }, props.placeholder), keyboardElement));\n});","map":{"version":3,"names":["React","forwardRef","useEffect","useImperativeHandle","useRef","useState","withNativeProps","mergeProps","usePropsValue","classNames","CloseCircleFill","useIsomorphicLayoutEffect","classPrefix","defaultProps","defaultValue","VirtualInput","p","ref","props","value","setValue","rootRef","contentRef","hasFocus","setHasFocus","scrollToEnd","root","current","document","activeElement","content","scrollLeft","clientWidth","focus","_a","blur","onFocus","call","onBlur","keyboard","keyboardElement","cloneElement","onInput","v","_b","onDelete","slice","visible","onClose","_c","getContainer","createElement","className","disabled","tabIndex","undefined","onClick","clearable","e","stopPropagation","onClear","placeholder"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/node_modules/antd-mobile/es/components/virtual-input/virtual-input.js"],"sourcesContent":["import React, { forwardRef, useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport classNames from 'classnames';\nimport { CloseCircleFill } from 'antd-mobile-icons';\nimport { useIsomorphicLayoutEffect } from 'ahooks';\nconst classPrefix = 'adm-virtual-input';\nconst defaultProps = {\n  defaultValue: ''\n};\nexport const VirtualInput = forwardRef((p, ref) => {\n  const props = mergeProps(defaultProps, p);\n  const [value, setValue] = usePropsValue(props);\n  const rootRef = useRef(null);\n  const contentRef = useRef(null);\n  const [hasFocus, setHasFocus] = useState(false);\n\n  function scrollToEnd() {\n    const root = rootRef.current;\n    if (!root) return;\n\n    if (document.activeElement !== root) {\n      return;\n    }\n\n    const content = contentRef.current;\n    if (!content) return;\n    content.scrollLeft = content.clientWidth;\n  }\n\n  useIsomorphicLayoutEffect(() => {\n    scrollToEnd();\n  }, [value]);\n  useEffect(() => {\n    if (hasFocus) {\n      scrollToEnd();\n    }\n  }, [hasFocus]);\n  useImperativeHandle(ref, () => ({\n    focus: () => {\n      var _a;\n\n      (_a = rootRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n    },\n    blur: () => {\n      var _a;\n\n      (_a = rootRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n    }\n  }));\n\n  function onFocus() {\n    var _a;\n\n    setHasFocus(true);\n    (_a = props.onFocus) === null || _a === void 0 ? void 0 : _a.call(props);\n  }\n\n  function onBlur() {\n    var _a;\n\n    setHasFocus(false);\n    (_a = props.onBlur) === null || _a === void 0 ? void 0 : _a.call(props);\n  }\n\n  const keyboard = props.keyboard;\n  const keyboardElement = keyboard && React.cloneElement(keyboard, {\n    onInput: v => {\n      var _a, _b;\n\n      setValue(value + v);\n      (_b = (_a = keyboard.props).onInput) === null || _b === void 0 ? void 0 : _b.call(_a, v);\n    },\n    onDelete: () => {\n      var _a, _b;\n\n      setValue(value.slice(0, -1));\n      (_b = (_a = keyboard.props).onDelete) === null || _b === void 0 ? void 0 : _b.call(_a);\n    },\n    visible: hasFocus,\n    onClose: () => {\n      var _a, _b, _c;\n\n      (_a = rootRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n      (_c = (_b = keyboard.props).onClose) === null || _c === void 0 ? void 0 : _c.call(_b);\n    },\n    getContainer: null\n  });\n  return withNativeProps(props, React.createElement(\"div\", {\n    ref: rootRef,\n    className: classNames(classPrefix, {\n      [`${classPrefix}-disabled`]: props.disabled\n    }),\n    tabIndex: props.disabled ? undefined : 0,\n    onFocus: onFocus,\n    onBlur: onBlur,\n    onClick: props.onClick\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-content`,\n    ref: contentRef\n  }, value, React.createElement(\"div\", {\n    className: `${classPrefix}-caret-container`\n  }, hasFocus && React.createElement(\"div\", {\n    className: `${classPrefix}-caret`\n  }))), props.clearable && !!value && hasFocus && React.createElement(\"div\", {\n    className: `${classPrefix}-clear`,\n    onClick: e => {\n      var _a;\n\n      e.stopPropagation();\n      setValue('');\n      (_a = props.onClear) === null || _a === void 0 ? void 0 : _a.call(props);\n    }\n  }, React.createElement(CloseCircleFill, null)), !value && React.createElement(\"div\", {\n    className: `${classPrefix}-placeholder`\n  }, props.placeholder), keyboardElement));\n});"],"mappings":"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"},"metadata":{},"sourceType":"module"}