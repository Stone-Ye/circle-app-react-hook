{"ast":null,"code":"import _defineProperty from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _createForOfIteratorHelper from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _slicedToArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useState, useEffect, useMemo } from 'react';\nimport classNames from 'classnames';\nimport Tabs from '../tabs';\nimport CheckList from '../check-list';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { useCascaderValueExtend } from './use-cascader-value-extend';\nimport { useConfig } from '../config-provider';\nimport { optionSkeleton } from './option-skeleton';\nimport Skeleton from '../skeleton';\nimport { useUpdateEffect } from 'ahooks';\nvar classPrefix = \"adm-cascader-view\";\nvar defaultProps = {\n  defaultValue: []\n};\nexport var CascaderView = function CascaderView(p) {\n  var _useConfig = useConfig(),\n      locale = _useConfig.locale;\n\n  var props = mergeProps(defaultProps, {\n    placeholder: locale.Cascader.placeholder\n  }, p);\n\n  var _usePropsValue = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: function onChange(val) {\n      var _a;\n\n      (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, val, generateValueExtend(val));\n    }\n  })),\n      _usePropsValue2 = _slicedToArray(_usePropsValue, 2),\n      value = _usePropsValue2[0],\n      setValue = _usePropsValue2[1];\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      tabActiveIndex = _useState2[0],\n      setTabActiveIndex = _useState2[1];\n\n  useUpdateEffect(function () {\n    var _a;\n\n    (_a = props.onTabsChange) === null || _a === void 0 ? void 0 : _a.call(props, tabActiveIndex);\n  }, [tabActiveIndex]);\n  var generateValueExtend = useCascaderValueExtend(props.options);\n  var levels = useMemo(function () {\n    var ret = [];\n    var currentOptions = props.options;\n    var reachedEnd = false;\n\n    var _iterator = _createForOfIteratorHelper(value),\n        _step;\n\n    try {\n      var _loop = function _loop() {\n        var v = _step.value;\n        var target = currentOptions.find(function (option) {\n          return option.value === v;\n        });\n        ret.push({\n          selected: target,\n          options: currentOptions\n        });\n\n        if (!target || !target.children) {\n          reachedEnd = true;\n          return \"break\";\n        }\n\n        currentOptions = target.children;\n      };\n\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var _ret = _loop();\n\n        if (_ret === \"break\") break;\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n\n    if (!reachedEnd) {\n      ret.push({\n        selected: undefined,\n        options: currentOptions\n      });\n    }\n\n    return ret;\n  }, [value, props.options]);\n  useEffect(function () {\n    setTabActiveIndex(levels.length - 1);\n  }, [value]);\n  useEffect(function () {\n    var max = levels.length - 1;\n\n    if (tabActiveIndex > max) {\n      setTabActiveIndex(max);\n    }\n  }, [tabActiveIndex, levels]);\n\n  var onItemSelect = function onItemSelect(selectValue, depth) {\n    var next = value.slice(0, depth);\n\n    if (selectValue !== undefined) {\n      next[depth] = selectValue;\n    }\n\n    setValue(next);\n  };\n\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(Tabs, {\n    activeKey: tabActiveIndex.toString(),\n    onChange: function onChange(key) {\n      var activeIndex = parseInt(key);\n      setTabActiveIndex(activeIndex);\n    },\n    stretch: false,\n    className: \"\".concat(classPrefix, \"-tabs\")\n  }, levels.map(function (level, index) {\n    var selected = level.selected;\n    return React.createElement(Tabs.Tab, {\n      key: index.toString(),\n      title: React.createElement(\"div\", {\n        className: \"\".concat(classPrefix, \"-header-title\")\n      }, selected ? selected.label : props.placeholder),\n      forceRender: true\n    }, React.createElement(\"div\", {\n      className: \"\".concat(classPrefix, \"-content\")\n    }, level.options === optionSkeleton ? React.createElement(\"div\", {\n      className: \"\".concat(classPrefix, \"-skeleton\")\n    }, React.createElement(Skeleton, {\n      className: \"\".concat(classPrefix, \"-skeleton-line-1\"),\n      animated: true\n    }), React.createElement(Skeleton, {\n      className: \"\".concat(classPrefix, \"-skeleton-line-2\"),\n      animated: true\n    }), React.createElement(Skeleton, {\n      className: \"\".concat(classPrefix, \"-skeleton-line-3\"),\n      animated: true\n    }), React.createElement(Skeleton, {\n      className: \"\".concat(classPrefix, \"-skeleton-line-4\"),\n      animated: true\n    })) : React.createElement(CheckList, {\n      value: [value[index]],\n      onChange: function onChange(selectValue) {\n        return onItemSelect(selectValue[0], index);\n      },\n      activeIcon: props.activeIcon\n    }, level.options.map(function (option) {\n      var active = value[index] === option.value;\n      return React.createElement(CheckList.Item, {\n        value: option.value,\n        key: option.value,\n        disabled: option.disabled,\n        className: classNames(\"\".concat(classPrefix, \"-item\"), _defineProperty({}, \"\".concat(classPrefix, \"-item-active\"), active))\n      }, option.label);\n    }))));\n  }))));\n};","map":{"version":3,"names":["React","useState","useEffect","useMemo","classNames","Tabs","CheckList","withNativeProps","mergeProps","usePropsValue","useCascaderValueExtend","useConfig","optionSkeleton","Skeleton","useUpdateEffect","classPrefix","defaultProps","defaultValue","CascaderView","p","locale","props","placeholder","Cascader","Object","assign","onChange","val","_a","call","generateValueExtend","value","setValue","tabActiveIndex","setTabActiveIndex","onTabsChange","options","levels","ret","currentOptions","reachedEnd","v","target","find","option","push","selected","children","undefined","length","max","onItemSelect","selectValue","depth","next","slice","createElement","className","activeKey","toString","key","activeIndex","parseInt","stretch","map","level","index","Tab","title","label","forceRender","animated","activeIcon","active","Item","disabled"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/node_modules/antd-mobile/es/components/cascader-view/cascader-view.js"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\nimport classNames from 'classnames';\nimport Tabs from '../tabs';\nimport CheckList from '../check-list';\nimport { withNativeProps } from '../../utils/native-props';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { usePropsValue } from '../../utils/use-props-value';\nimport { useCascaderValueExtend } from './use-cascader-value-extend';\nimport { useConfig } from '../config-provider';\nimport { optionSkeleton } from './option-skeleton';\nimport Skeleton from '../skeleton';\nimport { useUpdateEffect } from 'ahooks';\nconst classPrefix = `adm-cascader-view`;\nconst defaultProps = {\n  defaultValue: []\n};\nexport const CascaderView = p => {\n  const {\n    locale\n  } = useConfig();\n  const props = mergeProps(defaultProps, {\n    placeholder: locale.Cascader.placeholder\n  }, p);\n  const [value, setValue] = usePropsValue(Object.assign(Object.assign({}, props), {\n    onChange: val => {\n      var _a;\n\n      (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, val, generateValueExtend(val));\n    }\n  }));\n  const [tabActiveIndex, setTabActiveIndex] = useState(0);\n  useUpdateEffect(() => {\n    var _a;\n\n    (_a = props.onTabsChange) === null || _a === void 0 ? void 0 : _a.call(props, tabActiveIndex);\n  }, [tabActiveIndex]);\n  const generateValueExtend = useCascaderValueExtend(props.options);\n  const levels = useMemo(() => {\n    const ret = [];\n    let currentOptions = props.options;\n    let reachedEnd = false;\n\n    for (const v of value) {\n      const target = currentOptions.find(option => option.value === v);\n      ret.push({\n        selected: target,\n        options: currentOptions\n      });\n\n      if (!target || !target.children) {\n        reachedEnd = true;\n        break;\n      }\n\n      currentOptions = target.children;\n    }\n\n    if (!reachedEnd) {\n      ret.push({\n        selected: undefined,\n        options: currentOptions\n      });\n    }\n\n    return ret;\n  }, [value, props.options]);\n  useEffect(() => {\n    setTabActiveIndex(levels.length - 1);\n  }, [value]);\n  useEffect(() => {\n    const max = levels.length - 1;\n\n    if (tabActiveIndex > max) {\n      setTabActiveIndex(max);\n    }\n  }, [tabActiveIndex, levels]);\n\n  const onItemSelect = (selectValue, depth) => {\n    const next = value.slice(0, depth);\n\n    if (selectValue !== undefined) {\n      next[depth] = selectValue;\n    }\n\n    setValue(next);\n  };\n\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: classPrefix\n  }, React.createElement(Tabs, {\n    activeKey: tabActiveIndex.toString(),\n    onChange: key => {\n      const activeIndex = parseInt(key);\n      setTabActiveIndex(activeIndex);\n    },\n    stretch: false,\n    className: `${classPrefix}-tabs`\n  }, levels.map((level, index) => {\n    const selected = level.selected;\n    return React.createElement(Tabs.Tab, {\n      key: index.toString(),\n      title: React.createElement(\"div\", {\n        className: `${classPrefix}-header-title`\n      }, selected ? selected.label : props.placeholder),\n      forceRender: true\n    }, React.createElement(\"div\", {\n      className: `${classPrefix}-content`\n    }, level.options === optionSkeleton ? React.createElement(\"div\", {\n      className: `${classPrefix}-skeleton`\n    }, React.createElement(Skeleton, {\n      className: `${classPrefix}-skeleton-line-1`,\n      animated: true\n    }), React.createElement(Skeleton, {\n      className: `${classPrefix}-skeleton-line-2`,\n      animated: true\n    }), React.createElement(Skeleton, {\n      className: `${classPrefix}-skeleton-line-3`,\n      animated: true\n    }), React.createElement(Skeleton, {\n      className: `${classPrefix}-skeleton-line-4`,\n      animated: true\n    })) : React.createElement(CheckList, {\n      value: [value[index]],\n      onChange: selectValue => onItemSelect(selectValue[0], index),\n      activeIcon: props.activeIcon\n    }, level.options.map(option => {\n      const active = value[index] === option.value;\n      return React.createElement(CheckList.Item, {\n        value: option.value,\n        key: option.value,\n        disabled: option.disabled,\n        className: classNames(`${classPrefix}-item`, {\n          [`${classPrefix}-item-active`]: active\n        })\n      }, option.label);\n    }))));\n  }))));\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}