{"ast":null,"code":"import _slicedToArray from\"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useNavigate,useLocation}from'react-router-dom';import styles from'./index.module.css';import{getUserName,removeUserName,isAuth,getAllUserInfos}from'../Utils/global';import{Button,ImageUploader}from\"antd-mobile\";import HeadNav from'../Component/HeadNav';import{UploadImg}from'../Utils/uploadImg';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Me(){var location=useLocation();var navigate=useNavigate();var defaultAvataUrl='https://s2.loli.net/2022/10/05/mHKQROAML3vdDC9.png';var _useState=useState([{url:defaultAvataUrl}]),_useState2=_slicedToArray(_useState,2),fileList=_useState2[0],setFileList=_useState2[1];// 设置登录状态state\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLogin=_useState4[0],setisLogin=_useState4[1];var _useState5=useState({'avatarUrl':defaultAvataUrl,'userName':'Tourist'}),_useState6=_slicedToArray(_useState5,2),userInfo=_useState6[0],setUserinfo=_useState6[1];// 监听页面跳转和logout\nuseEffect(function(){setisLogin(isAuth());},[location,isLogin]);useEffect(function(){var allUserInfos=getAllUserInfos();if(getUserName()){setUserinfo(allUserInfos[getUserName()]);}},[]);return/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsx(HeadNav,{title:\"My Profile\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.user,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.avata,children:[/*#__PURE__*/_jsx(\"img\",{src:userInfo.avatarUrl?userInfo.avatarUrl:defaultAvataUrl,alt:\"avata_img\",onClick:function onClick(){}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:userInfo.userName?userInfo.userName:'Tourist'}),/*#__PURE__*/_jsx(\"div\",{children:isLogin?/*#__PURE__*/_jsx(\"div\",{className:styles.auth,children:/*#__PURE__*/_jsx(Button,{color:\"success\",size:\"small\",onClick:function onClick(){removeUserName();setisLogin(false);setUserinfo([]);},children:\"Logout\"})}):/*#__PURE__*/_jsx(\"div\",{className:styles.edit,children:/*#__PURE__*/_jsx(Button,{color:\"success\",size:\"small\",onClick:function onClick(){navigate(\"/login\");},children:\"login\"})})})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:styles.body,children:[/*#__PURE__*/_jsx(\"div\",{className:styles.list,children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){navigate('/offerhistory',{replace:true});},children:\"Offer History\"})}),/*#__PURE__*/_jsx(\"div\",{className:styles.list,children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){navigate('/wishlist',{replace:true});},children:\"Wish List\"})}),/*#__PURE__*/_jsx(\"div\",{className:styles.list,children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){navigate('/postlist',{replace:true});},children:\"Post List\"})})]})]});}","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useLocation","styles","getUserName","removeUserName","isAuth","getAllUserInfos","Button","ImageUploader","HeadNav","UploadImg","Me","location","navigate","defaultAvataUrl","url","fileList","setFileList","isLogin","setisLogin","userInfo","setUserinfo","allUserInfos","container","user","avata","avatarUrl","userName","auth","edit","body","list","replace"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/src/views/Me/index.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { useNavigate, useLocation } from 'react-router-dom'\nimport styles from './index.module.css'\nimport { getUserName, removeUserName, isAuth, getAllUserInfos } from '../Utils/global'\nimport { Button, ImageUploader } from \"antd-mobile\"\nimport HeadNav from '../Component/HeadNav'\nimport { UploadImg } from '../Utils/uploadImg'\n\nexport default function Me () {\n\n  const location = useLocation()\n  const navigate = useNavigate()\n  const defaultAvataUrl = 'https://s2.loli.net/2022/10/05/mHKQROAML3vdDC9.png'\n  const [fileList, setFileList] = useState([{ url: defaultAvataUrl, }])\n\n  // 设置登录状态state\n  const [isLogin, setisLogin] = useState(false)\n  const [userInfo, setUserinfo] = useState({\n    'avatarUrl': defaultAvataUrl,\n    'userName': 'Tourist'\n  })\n\n\n\n  // 监听页面跳转和logout\n  useEffect(() => {\n    setisLogin(isAuth())\n  }, [location, isLogin])\n\n  useEffect(() => {\n    let allUserInfos = getAllUserInfos()\n    if (getUserName()) {\n      setUserinfo(allUserInfos[getUserName()])\n    }\n  }, [])\n\n\n\n\n\n  return <div className={styles.container}>\n    <HeadNav title='My Profile' />\n\n    <div className={styles.user}>\n      <div className={styles.avata}>\n        <img\n          src={userInfo.avatarUrl ? userInfo.avatarUrl : defaultAvataUrl}\n          alt=\"avata_img\"\n          onClick={() => {\n          }}\n        />\n        <div>\n          <div>{userInfo.userName ? userInfo.userName : 'Tourist'}</div>\n          {/* <Link to=\"/editprofile\">Edit Profile</Link> */}\n          <div>{isLogin\n            ? (<div className={styles.auth}>\n              <Button\n                color=\"success\"\n                size=\"small\"\n                onClick={() => {\n                  removeUserName()\n                  setisLogin(false)\n                  setUserinfo([])\n                }}>\n                Logout\n              </Button>\n            </div>) :\n            (<div className={styles.edit}>\n              <Button\n                color=\"success\"\n                size=\"small\"\n                onClick={() => { navigate(`/login`) }}>\n                login\n              </Button>\n            </div>\n\n            )\n          }</div>\n        </div>\n      </div>\n    </div>\n\n\n    <div className={styles.body}>\n      <div className={styles.list}>\n        <Button onClick={() => { navigate('/offerhistory', { replace: true }) }}>Offer History</Button>\n      </div>\n      <div className={styles.list}>\n        <Button onClick={() => { navigate('/wishlist', { replace: true }) }}>Wish List</Button>\n      </div>\n      <div className={styles.list}>\n        <Button onClick={() => { navigate('/postlist', { replace: true }) }}>Post List</Button>\n      </div>\n    </div>\n\n  </div>\n\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}