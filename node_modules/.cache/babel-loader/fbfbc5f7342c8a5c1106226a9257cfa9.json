{"ast":null,"code":"import _slicedToArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport { renderToBody } from './render-to-body';\nexport function renderImperatively(element) {\n  var Wrapper = React.forwardRef(function (_, ref) {\n    var _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        visible = _useState2[0],\n        setVisible = _useState2[1];\n\n    var closedRef = useRef(false);\n\n    var _useState3 = useState(element),\n        _useState4 = _slicedToArray(_useState3, 2),\n        elementToRender = _useState4[0],\n        setElementToRender = _useState4[1];\n\n    var keyRef = useRef(0);\n    useEffect(function () {\n      if (!closedRef.current) {\n        setVisible(true);\n      } else {\n        afterClose();\n      }\n    }, []);\n\n    function onClose() {\n      var _a, _b;\n\n      closedRef.current = true;\n      setVisible(false);\n      (_b = (_a = elementToRender.props).onClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n    }\n\n    function afterClose() {\n      var _a, _b;\n\n      unmount();\n      (_b = (_a = elementToRender.props).afterClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n    }\n\n    useImperativeHandle(ref, function () {\n      return {\n        close: onClose,\n        replace: function replace(element) {\n          var _a, _b;\n\n          keyRef.current++;\n          (_b = (_a = elementToRender.props).afterClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n          setElementToRender(element);\n        }\n      };\n    });\n    return React.cloneElement(elementToRender, Object.assign(Object.assign({}, elementToRender.props), {\n      key: keyRef.current,\n      visible: visible,\n      onClose: onClose,\n      afterClose: afterClose\n    }));\n  });\n  var wrapperRef = React.createRef();\n  var unmount = renderToBody(React.createElement(Wrapper, {\n    ref: wrapperRef\n  }));\n  return {\n    close: function close() {\n      var _a;\n\n      (_a = wrapperRef.current) === null || _a === void 0 ? void 0 : _a.close();\n    },\n    replace: function replace(element) {\n      var _a;\n\n      (_a = wrapperRef.current) === null || _a === void 0 ? void 0 : _a.replace(element);\n    }\n  };\n}","map":{"version":3,"names":["React","useEffect","useImperativeHandle","useRef","useState","renderToBody","renderImperatively","element","Wrapper","forwardRef","_","ref","visible","setVisible","closedRef","elementToRender","setElementToRender","keyRef","current","afterClose","onClose","_a","_b","props","call","unmount","close","replace","cloneElement","Object","assign","key","wrapperRef","createRef","createElement"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/node_modules/antd-mobile/es/utils/render-imperatively.js"],"sourcesContent":["import React, { useEffect, useImperativeHandle, useRef, useState } from 'react';\nimport { renderToBody } from './render-to-body';\nexport function renderImperatively(element) {\n  const Wrapper = React.forwardRef((_, ref) => {\n    const [visible, setVisible] = useState(false);\n    const closedRef = useRef(false);\n    const [elementToRender, setElementToRender] = useState(element);\n    const keyRef = useRef(0);\n    useEffect(() => {\n      if (!closedRef.current) {\n        setVisible(true);\n      } else {\n        afterClose();\n      }\n    }, []);\n\n    function onClose() {\n      var _a, _b;\n\n      closedRef.current = true;\n      setVisible(false);\n      (_b = (_a = elementToRender.props).onClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n    }\n\n    function afterClose() {\n      var _a, _b;\n\n      unmount();\n      (_b = (_a = elementToRender.props).afterClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n    }\n\n    useImperativeHandle(ref, () => ({\n      close: onClose,\n      replace: element => {\n        var _a, _b;\n\n        keyRef.current++;\n        (_b = (_a = elementToRender.props).afterClose) === null || _b === void 0 ? void 0 : _b.call(_a);\n        setElementToRender(element);\n      }\n    }));\n    return React.cloneElement(elementToRender, Object.assign(Object.assign({}, elementToRender.props), {\n      key: keyRef.current,\n      visible,\n      onClose,\n      afterClose\n    }));\n  });\n  const wrapperRef = React.createRef();\n  const unmount = renderToBody(React.createElement(Wrapper, {\n    ref: wrapperRef\n  }));\n  return {\n    close: () => {\n      var _a;\n\n      (_a = wrapperRef.current) === null || _a === void 0 ? void 0 : _a.close();\n    },\n    replace: element => {\n      var _a;\n\n      (_a = wrapperRef.current) === null || _a === void 0 ? void 0 : _a.replace(element);\n    }\n  };\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}