{"ast":null,"code":"import _toConsumableArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/Users/stoneye/react_project/circle-app-react-hook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport React, { memo, useCallback, useEffect, useState } from 'react';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { Wheel } from './wheel';\nimport { useColumnsExtend } from './columns-extend';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useDebounceEffect } from 'ahooks';\nimport { defaultRenderLabel } from '../picker/picker-utils';\nimport SpinLoading from '../spin-loading';\nvar classPrefix = \"adm-picker-view\";\nvar defaultProps = {\n  defaultValue: [],\n  renderLabel: defaultRenderLabel,\n  mouseWheel: false,\n  loadingContent: React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-loading-content\")\n  }, React.createElement(SpinLoading, null))\n};\nexport var PickerView = memo(function (p) {\n  var props = mergeProps(defaultProps, p);\n\n  var _useState = useState(props.value === undefined ? props.defaultValue : props.value),\n      _useState2 = _slicedToArray(_useState, 2),\n      innerValue = _useState2[0],\n      setInnerValue = _useState2[1]; // Sync `value` to `innerValue`\n\n\n  useEffect(function () {\n    if (props.value === undefined) return; // Uncontrolled mode\n\n    if (props.value === innerValue) return;\n    setInnerValue(props.value);\n  }, [props.value]);\n  useEffect(function () {\n    if (props.value === innerValue) return;\n    var timeout = window.setTimeout(function () {\n      if (props.value !== undefined && props.value !== innerValue) {\n        setInnerValue(props.value);\n      }\n    }, 1000);\n    return function () {\n      window.clearTimeout(timeout);\n    };\n  }, [props.value, innerValue]);\n  var extend = useColumnsExtend(props.columns, innerValue);\n  var columns = extend.columns;\n  useDebounceEffect(function () {\n    var _a;\n\n    if (props.value === innerValue) return;\n    (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, innerValue, extend);\n  }, [innerValue], {\n    wait: 0,\n    leading: false,\n    trailing: true\n  });\n  var handleSelect = useCallback(function (val, index) {\n    setInnerValue(function (prev) {\n      var next = _toConsumableArray(prev);\n\n      next[index] = val;\n      return next;\n    });\n  }, []);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: \"\".concat(classPrefix)\n  }, props.loading ? props.loadingContent : React.createElement(React.Fragment, null, columns.map(function (column, index) {\n    return React.createElement(Wheel, {\n      key: index,\n      index: index,\n      column: column,\n      value: innerValue[index],\n      onSelect: handleSelect,\n      renderLabel: props.renderLabel,\n      mouseWheel: props.mouseWheel\n    });\n  }), React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-mask\")\n  }, React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-mask-top\")\n  }), React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-mask-middle\")\n  }), React.createElement(\"div\", {\n    className: \"\".concat(classPrefix, \"-mask-bottom\")\n  })))));\n});\nPickerView.displayName = 'PickerView';","map":{"version":3,"names":["React","memo","useCallback","useEffect","useState","mergeProps","Wheel","useColumnsExtend","withNativeProps","useDebounceEffect","defaultRenderLabel","SpinLoading","classPrefix","defaultProps","defaultValue","renderLabel","mouseWheel","loadingContent","createElement","className","PickerView","p","props","value","undefined","innerValue","setInnerValue","timeout","window","setTimeout","clearTimeout","extend","columns","_a","onChange","call","wait","leading","trailing","handleSelect","val","index","prev","next","loading","Fragment","map","column","key","onSelect","displayName"],"sources":["/Users/stoneye/react_project/circle-app-react-hook/node_modules/antd-mobile/es/components/picker-view/picker-view.js"],"sourcesContent":["import React, { memo, useCallback, useEffect, useState } from 'react';\nimport { mergeProps } from '../../utils/with-default-props';\nimport { Wheel } from './wheel';\nimport { useColumnsExtend } from './columns-extend';\nimport { withNativeProps } from '../../utils/native-props';\nimport { useDebounceEffect } from 'ahooks';\nimport { defaultRenderLabel } from '../picker/picker-utils';\nimport SpinLoading from '../spin-loading';\nconst classPrefix = `adm-picker-view`;\nconst defaultProps = {\n  defaultValue: [],\n  renderLabel: defaultRenderLabel,\n  mouseWheel: false,\n  loadingContent: React.createElement(\"div\", {\n    className: `${classPrefix}-loading-content`\n  }, React.createElement(SpinLoading, null))\n};\nexport const PickerView = memo(p => {\n  const props = mergeProps(defaultProps, p);\n  const [innerValue, setInnerValue] = useState(props.value === undefined ? props.defaultValue : props.value); // Sync `value` to `innerValue`\n\n  useEffect(() => {\n    if (props.value === undefined) return; // Uncontrolled mode\n\n    if (props.value === innerValue) return;\n    setInnerValue(props.value);\n  }, [props.value]);\n  useEffect(() => {\n    if (props.value === innerValue) return;\n    const timeout = window.setTimeout(() => {\n      if (props.value !== undefined && props.value !== innerValue) {\n        setInnerValue(props.value);\n      }\n    }, 1000);\n    return () => {\n      window.clearTimeout(timeout);\n    };\n  }, [props.value, innerValue]);\n  const extend = useColumnsExtend(props.columns, innerValue);\n  const columns = extend.columns;\n  useDebounceEffect(() => {\n    var _a;\n\n    if (props.value === innerValue) return;\n    (_a = props.onChange) === null || _a === void 0 ? void 0 : _a.call(props, innerValue, extend);\n  }, [innerValue], {\n    wait: 0,\n    leading: false,\n    trailing: true\n  });\n  const handleSelect = useCallback((val, index) => {\n    setInnerValue(prev => {\n      const next = [...prev];\n      next[index] = val;\n      return next;\n    });\n  }, []);\n  return withNativeProps(props, React.createElement(\"div\", {\n    className: `${classPrefix}`\n  }, props.loading ? props.loadingContent : React.createElement(React.Fragment, null, columns.map((column, index) => React.createElement(Wheel, {\n    key: index,\n    index: index,\n    column: column,\n    value: innerValue[index],\n    onSelect: handleSelect,\n    renderLabel: props.renderLabel,\n    mouseWheel: props.mouseWheel\n  })), React.createElement(\"div\", {\n    className: `${classPrefix}-mask`\n  }, React.createElement(\"div\", {\n    className: `${classPrefix}-mask-top`\n  }), React.createElement(\"div\", {\n    className: `${classPrefix}-mask-middle`\n  }), React.createElement(\"div\", {\n    className: `${classPrefix}-mask-bottom`\n  })))));\n});\nPickerView.displayName = 'PickerView';"],"mappings":"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"},"metadata":{},"sourceType":"module"}